-- Insert crypté manuellement
OPEN SYMMETRIC KEY BAMKEY192 DECRYPTION BY CERTIFICATE BOOKSANDMOVIESCERTIFICATE
OPEN SYMMETRIC KEY BAMKEY256 DECRYPTION BY CERTIFICATE BOOKSANDMOVIESCERTIFICATE

INSERT INTO UTILISATEUR (NOM_CRYPT, PRENOM_CRYPT, ADRESSEMAIL_CRYPT, MOTDEPASSE_CRYPT,DATENAISSANCE_CRYPT,LASTCONNEXION)
VALUES
(EncryptByKey(Key_GUID('BAMKEY192'), NOM), EncryptByKey(Key_GUID('BAMKEY192'), PRENOM), EncryptByKey(Key_GUID('BAMKEY192'), ADRESSEMAIL), EncryptByKey(Key_GUID('BAMKEY256'), MOTDEPASSE),EncryptByKey(Key_GUID('BAMKEY192'), CONVERT(varchar, DATENAISSANCE)),'02/06/2020')

CLOSE SYMMETRIC KEY BAMKEY256
CLOSE SYMMETRIC KEY BAMKEY192

-- Insert crypté grâce à un procédure stockée (nécessite l'execution du fichier BOOKSANDMOVIES-ProcStockee.txt)
exec dbo.insertUtilisateur 'POITOU','Stéphane','Steph.pouitou@yahoo.fr','keval0611','08/10/1976';